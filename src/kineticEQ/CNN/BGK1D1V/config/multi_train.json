{
  "_comment": "Default sweep config for multi_train.py. Edit base_args and sweep as needed.",

  "base_args": {
    "epochs": 20,
    "batch": 512,
    "lr": 5e-4,
    "workers": 9,
    "prefetch_factor": 8,
    "amp": true,
    "seed": 42,
    
    "loss_kind": "smoothl1",
    "delta_type": "dnu",
    "loss_softmax_beta": 20.0,
    "loss_eps": 1e-6,
    "nb": 10,
    "n_floor": 1e-8,
    "T_floor": 1e-8,

    "shock_ratio": 0.5,
    "shock_q": 0.65,
    "shock_loss_kind": "softmax",
    "shock_loss_softmax_beta": 20.0,
    "shock_loss_eps": 1e-6,

    "hidden": 256,
    "n_blocks": 6,
    "kernel": 5,
    "gn_groups": 32,
    "bottleneck": 0.5,
    "dilation_cycle": [1, 2],
    "use_gate_head": 1,
    "gate_bias_init": -4.0,
    "gate_scale": 1.0,
    "gate_per_channel": 0,

    "grad_clip": 1.0,
    "log_interval": 50,

    "sched_plateau": true,
    "sched_patience": 3,
    "sched_factor": 0.5,
    "sched_min_lr": 1e-6,

    "warm_eval": true,
    "warm_eval_tau": 5e-7,
    "warm_eval_dt": 5e-5,
    "warm_eval_T_total": 0.05,
    "warm_eval_picard_iter": 100000,
    "warm_eval_picard_tol": 1e-5,
    "warm_eval_abs_tol": 1e-13,
    "warm_eval_nx": 512,
    "warm_eval_nv": 256
  },

  "sweep": {
    "shock_ratio": [0.5,0.8,1.0],
    "shock_q": [0.65,0.8,0.9],
    "shock_loss_softmax_beta": [20.0,10.0,5.0]
  },

  "save_root": "sweep_runs/default"
}
